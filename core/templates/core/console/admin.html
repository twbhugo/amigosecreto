<html lang="es">
{% load static %}
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Navidad 2025 - Panel de Administración</title>
    <!-- Bootstrap 5.3 CDN -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="{% static 'core/css/custom-console.css' %}" rel="stylesheet" >
</head>
<body>
    <div class="container w-75 mx-auto pt-3">
        <div class="bg-light text-dark rounded-5 shadow-lg p-4">
            
            <header class="mb-4 d-flex flex-column align-items-center gap-2">
                <h1 class="h1 text-center mb-1">Familia Torres</h1>
                <h5 class="h5 text-center text-muted mb-0">Control Panel</h5>
                <a href="{% url 'dashboard' %}" class="btn btn-outline-info btn-sm">← Back to Dashboard</a>
            </header>

            <div class="card shadow shadow-lg mb-4">
                <div class="card-header bg-secondary text-white mb-3">
                    Admin Actions
                </div>
                <div class="card-body">
                    <form method="POST" action="">
                        {% csrf_token %}
                        <!--Clear all confirmations-->
                        <button type="submit" name="clearConfirmations" value="clear_confirmations" class="btn btn-info btn-sm">Clear All Confirmations</button>
                        <!--Reset Database-->
                        <button type="submit" name="resetDatabase" value="reset_database" class="btn btn-danger btn-sm">Reset Database</button>
                        <!--Assign PIN and Username-->
                        <a href="{% url 'assigments' %}?action=assignPinUser" name="assignPinUser" value="assignPinUser" class="btn btn-info btn-sm">Assign PINs and Usernames</a>
                        <!--Assign Secret Friends-->
                        <button type="submit" name="assignSecretFriends" value="assign_secret_friends" class="btn btn-info btn-sm">Assign Secret Friends</button>
                        <!--Unlock Users-->
                        <button type="submit" name="unlockUsers" value="unlock_users" class="btn btn-info btn-sm">Unlock Users</button>
                    </form>
                </div>
            </div>
            <!-- CARD: Add new Family Group -->
            <div class="card shadow shadow-lg">
                <div class="card-header bg-secondary text-white mb-3">
                    Add New Family Group
                </div>
                <div class="card-body">
                    <ul>
                        {% for family_group in family_groups %}
                            <li>{{family_group.family_group_id}}. Fam: {{ family_group.family_name }}</li>
                        {% empty %}
                            <li>No family groups added yet.</li>
                        {% endfor %}
                    </ul>
                </div>
                <div class="card-body">
                    <form method="POST" action="{% url 'save_family_group' %}">
                        {% csrf_token %}
                        <div class="mb-3">
                            <label for="family_name" class="form-label">Family Name:</label>
                            <input type="text" class="form-control" id="family_name" name="family_name" placeholder="Enter Family Name" required>
                        </div>
                        <button type="submit" name="action" value="save_family_group" class="btn btn-dark btn-sm">Add Family Name</button>
                    </form>
                </div>
            </div>

            <!--Gues's secret friend report showing Guest and its Secret Friend-->
            <div class="card shadow shadow-lg mt-4">
                <div class="card-header bg-secondary text-white mb-3">
                    Guest - Secret Friend Report
                </div>
                <div class="card-body">
                    <table class="table table-striped">
                        <thead>
                            <tr>
                                <th>Guest Name</th>
                                <th>Secret Friend Name</th>
                                <th>Secret Friend's Ideal Gift</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for report in secret_friend_reports %}
                            <tr>
                                <td>{{ report.guest_name }}</td>
                                <td>{{ report.secret_friend_name }}</td>
                                <td>{{ report.secret_friend_ideal_gift }}</td>
                            </tr>
                            {% empty %}
                            <tr>
                                <td colspan="3">No secret friend assignments yet.</td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>
</body>
</html>